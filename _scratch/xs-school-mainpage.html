<meta charset="utf-8">
<link rel="stylesheet" href="https://cdn.staticdn.net/css?family=Source+Sans+Pro:200,300,400,600,700" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/gh/CSharperMantle/CSharperMantle.github.io@HEAD/assets/img/6929a898263798cc12e14ee94ee62260116639c1.jpg" as="image">
<style>
  .no-selection {
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}

.center {
  text-align: center;
  margin: 0 auto;
}

.bordered-with-fieldset>fieldset {
  border-color: #000000;
}

.bordered-with-fieldset>fieldset>legend {
  font-size: 14pt;
}

#div-under-construction-banner {
  background: #f1f1f1;
}

#h2-under-construction-cap {
  font-family: 'Source Sans Pro';
  color: rgb(102, 102, 102);
  font-weight: normal;
}

#pre-user-agent {
  color: rgb(165, 165, 165);
  font-size: 6pt;
}

#h2-deprecated-banner {
  font-weight: bold;
  font-size: large;
  font-size: 15px;
}

/* Do the javascript's width adjusting jobs by CSS */
img {
  max-width: 740px;
}

/* These are for grids */
.container-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  grid-gap: 10px;
  grid-auto-rows: min-content;
  grid-auto-columns: min-content;
}

.grid-row-1 {
  grid-row: 1;
}

.grid-row-2 {
  grid-row: 2;
}

.grid-row-3 {
  grid-row: 3;
}

.grid-row-4 {
  grid-row: 4;
}

.grid-row-5 {
  grid-row: 5;
}

.grid-row-stretch {
  grid-column: 1 / -1;
}

/* These are for flexbox modeling */
.container-flex {
  display: flex;
  flex-flow: row wrap;
}

/* These are for better image display */
figure.gallery-fig {
  border: thin #c0c0c0 solid;
  display: flex;
  flex-flow: column;
  padding: 5px;
  margin: auto;
}

figure.gallery-fig>figcaption {
  background-color: #222;
  color: #fff;
  font: italic smaller sans-serif;
  padding: 3px;
  text-align: center;
}

/* Really simple non-jQuery sliders */
.slider {
  max-width: 800px;
  margin: 30px auto 0;
  padding: 30px;
  background: white;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.slider__images {
  opacity: 0;
  visibility: hidden;
  position: relative;
  top: 0px;
  left: 0px;
  list-style-type: none;
  -webkit-transition: opacity 0.4s ease-in, visibility 0.4s ease-in;
  transition: opacity 0.4s ease-in, visibility 0.4s ease-in;
}

.slider__images.loaded {
  opacity: 1;
  visibility: visible;
}

.slider__images-item {
  position: absolute;
  top: 0;
  left: 0;
}

.no-js .slider__images-item:first-of-type {
  position: relative;
}

.no-js .slider__images-item:not(:first-of-type) {
  display: none !important;
}

.slider__images-image {
  display: block;
}

.slider__controls {
  margin-top: 30px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  text-align: center;
}

.slider__control {
  display: inline-block;
  color: #829995;
  cursor: pointer;
}

.slider__control--prev {
  margin-right: 10px;
  border-radius: 3px;
  color: #333;
}

.slider__control--next {
  margin-left: 10px;
  border-radius: 3px;
  color: #333;
}

.slider__pagers {
  display: inline-block;
  margin: 0;
  padding: 0;
  list-style-type: none;
}

.slider__pagers button {
  display: inline-block;
  margin: 0 5px;
  cursor: pointer;
  color: #829995;
  border-radius: 3px;
  padding: 0 10px;
}

.slider__pagers button.active {
  color: #333;
}

</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prefixfree/1.0.7/prefixfree.min.js" integrity="sha512-p7Ey2nBhKYEi9yh0iDs+GMA0ttebOqVl3OO2oWRzRxtDoN/RedyYcHFUJZhMVi8NKRdEA7n+9NTNQX/kFIZgNw==" crossorigin="anonymous"></script>
<!-- Cerina, I will certainly become your deskmate next semester. -->
<main role="main">
  <div class="container-grid">
    <div id="div-under-construction-banner" class="no-selection grid-row-1 grid-row-stretch">
      <figure class="center" id="figure-under-construction">
        <img src="https://cdn.jsdelivr.net/gh/CSharperMantle/CSharperMantle.github.io@HEAD/assets/ico/travis_barrier.svg" alt="barrier image" width="254" height="179" style="border-bottom: 1px solid #DEDCDB;">
      </figure>
      <h2 id="h2-under-construction-cap" class="center">
        <span>Home page is under construction.</span>
        <br>
        <span>You may surf around freely during this time.</span>
      </h2>
      <span class="center">
        <pre id="pre-user-agent"></pre>
      </span>
      <br>
      <h2 id="h2-deprecated-banner" class="center" hidden="">This feature is deprecated and removed.</h2>
      <br>
    </div>
    <div id="div-class-banner" class="grid-row-2 grid-row-stretch">
      <figure id="figure-banner" class="center">
        <img class="switchable" src="https://cdn.jsdelivr.net/gh/CSharperMantle/CSharperMantle.github.io@HEAD/assets/img/9dc7dbc37a49c76baf071d9dab470ac330c8f49d.jpg" data-switch-cases="2" data-switch-current="0" data-switch-src-0="https://cdn.jsdelivr.net/gh/CSharperMantle/CSharperMantle.github.io@HEAD/assets/img/9dc7dbc37a49c76baf071d9dab470ac330c8f49d.jpg" data-switch-src-1="https://cdn.jsdelivr.net/gh/CSharperMantle/CSharperMantle.github.io@HEAD/assets/img/6929a898263798cc12e14ee94ee62260116639c1.jpg" alt="class flag">
      </figure>
    </div>
    <div id="div-teachers" class="bordered-with-fieldset grid-row-3 grid-row-stretch">
      <fieldset>
        <legend>
          <strong>Our teachers</strong> 教师风采
        </legend>
        <div class="slider-wrapper">
          <div class="slider">
            <ul class="js__slider__images slider__images">
              <li class="slider__images-item"><img class="slider__images-image" src="https://cdn.jsdelivr.net/gh/CSharperMantle/CSharperMantle.github.io@HEAD/assets/img/ee0b4bde13b80788cda21f08038a4e2e0b96780d.jpg" alt="石晓明 accepting a certificate"></li>
              <li class="slider__images-item"><img class="slider__images-image" src="https://cdn.jsdelivr.net/gh/CSharperMantle/CSharperMantle.github.io@HEAD/assets/img/695bbd9b8ccb764a29960b96a5e2b6ee72d32c89.jpg" alt="石晓明 giving a presentation"></li>
              <li class="slider__images-item"><img class="slider__images-image" src="https://cdn.jsdelivr.net/gh/CSharperMantle/CSharperMantle.github.io@HEAD/assets/img/2dec8192f83fbff00e41c26bb266428c27c2a089.jpg" alt="徐珑迪 playing basketball"></li>
              <li class="slider__images-item"><img class="slider__images-image" src="https://cdn.jsdelivr.net/gh/CSharperMantle/CSharperMantle.github.io@HEAD/assets/img/ec9b44ab0f6ec8486ca42eaffc2ee5a66914873a.jpg" alt="徐珑迪 and 翁嘉诚 playing basketball"></li>
              <li class="slider__images-item"><img class="slider__images-image" src="https://cdn.jsdelivr.net/gh/CSharperMantle/CSharperMantle.github.io@HEAD/assets/img/5fa49760f48b6f1f3530d8713d3457a7e0d982a7.jpg" alt="徐珑迪 with confidence"></li>
              <li class="slider__images-item"><img class="slider__images-image" src="https://cdn.jsdelivr.net/gh/CSharperMantle/CSharperMantle.github.io@HEAD/assets/img/5e60b61e090e98a66d2ebb1269cd56cf4575a646.jpg" alt="郑文韶"></li>
            </ul>
            <div class="slider__controls">
              <button class="slider__control js__slider__control--prev slider__control--prev" type="button">Prev</button>
              <ol class="js__slider__pagers slider__pagers"></ol>
              <button class="slider__control js__slider__control--next slider__control--next" type="button">Next</button>
            </div>
          </div>
        </div>
      </fieldset>
    </div>
    <div id="div-sotc" class="bordered-with-fieldset grid-row-4 grid-row-stretch">
      <fieldset>
        <legend>
          <strong>Star of the class</strong> 班级之星
        </legend>
        <div class="container-flex">
          <figure class="gallery-fig">
            <img src="https://cdn.jsdelivr.net/gh/CSharperMantle/CSharperMantle.github.io@HEAD/assets/img/a9091faa5d37e623addde502f26ca87b5d199195.jpg" alt="Aristotle">
            <figcaption>翁嘉诚, aka Aristotle, introducing his new business idea on a competition</figcaption>
          </figure>
          <figure class="gallery-fig">
            <img src="https://cdn.jsdelivr.net/gh/CSharperMantle/CSharperMantle.github.io@HEAD/assets/img/a37d30d89b78a16f7e71085b931ca3570ba25ba6.jpg" alt="Alan">
            <figcaption>梁扬荣, aka Alan or Spotty, holding a bottle of A Little Tea</figcaption>
          </figure>
        </div>
      </fieldset>
    </div>
  </div>
</main>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prefixfree/1.0.7/prefixfree.min.js" integrity="sha512-p7Ey2nBhKYEi9yh0iDs+GMA0ttebOqVl3OO2oWRzRxtDoN/RedyYcHFUJZhMVi8NKRdEA7n+9NTNQX/kFIZgNw==" crossorigin="anonymous"></script>
<script>
const DIV_GAME_CONTENT_BASE64 = "PGlmcmFtZSBoZWlnaHQ9IjcyMCIgc3R5bGU9IndpZHRoOiAxMDAlOyIgc2Nyb2xsaW5nPSJubyIgdGl0bGU9IkEgYmV0dGVyIG1hdHRlciBvZiBncmF2aXR5IiBzcmM9Imh0dHBzOi8vY29kZXBlbi5pby9DU2hhcnBlck1hbnRsZS9lbWJlZC9NV3lMWnZ5P2hlaWdodD0yNjUmdGhlbWUtaWQ9ZGFyayZkZWZhdWx0LXRhYj1qcyxyZXN1bHQiIGZyYW1lYm9yZGVyPSJubyIgbG9hZGluZz0ibGF6eSIgYWxsb3d0cmFuc3BhcmVuY3k9InRydWUiIGFsbG93ZnVsbHNjcmVlbj0idHJ1ZSI+PC9pZnJhbWU+";
const POPUP_GAME_CONTENT = "Please be patient. The construction might take a lot of time. In order to entertain you, I added a game. Click again to switch off.";

const ELEMID_PRE_USER_AGENT = "pre-user-agent";
const ELEMID_FIGURE_UNDER_CONSTRUCTION = "figure-under-construction";
const ELEMID_DIV_GAME = "div-game";
const ELEMID_PRE_LEGAL_DISCLAIMER = "pre-legal-disclaimer";
const ELEMID_H2_DEPRECATED_BANNER = "h2-deprecated-banner";
const ELEMID_FIGURE_BANENR = "figure-banner";
let isDeprecatedBannerShowing = false;

(function() {
  "use strict";

  function refreshSwitch(s) {
    let currentSwitch = s.dataset.switchCurrent;

    let switchAttrStr = "switchSrc-" + currentSwitch;
    let currentSwitchSrc = s.dataset[switchAttrStr];

    s.setAttribute("src", currentSwitchSrc);
  }

  function switchNext(s) {
    let currentSwitch = parseInt(s.dataset.switchCurrent, 10);
    let switchCases = parseInt(s.dataset.switchCases, 10);

    currentSwitch += 1;
    if (currentSwitch >= switchCases) {
      currentSwitch = 0;
    }

    s.dataset.switchCurrent = currentSwitch;
  }

  function initializeSwitch() {
    let switchables = document.getElementsByClassName("switchable");
    for (let i = 0; i < switchables.length; i += 1) {
      let switchable = switchables[i];
      refreshSwitch(switchable);
      switchable.addEventListener("click", () => {
        switchNext(switchable);
        refreshSwitch(switchable);
      });
    }
  }
  initializeSwitch();
})();

(function() {
  // ==GLOBAL VARS, CONSTS AND HELPERS==

  // create pager list items
  let sliderImagesList = document.querySelectorAll(".slider__images-image");
  let sliderPagersElem = document.querySelector(".js__slider__pagers"); // we will only fill the first pager element

  // HACK: fill in sliders in advance in order to get the total count of elements in LAST_ELEM_INDEX
  function sliderPagePrefill() {
    sliderImagesList.forEach((image, index) => {
      let buttonElem = document.createElement("button");
      let buttonText = document.createTextNode(index + 1);
      buttonElem.appendChild(buttonText);
      buttonElem.setAttribute("type", "button");
      sliderPagersElem.insertAdjacentElement("beforeend", buttonElem);

      //HACK: Chrome won't fire onload event for more than 1 time even the image's src has changed. This is to forcely rerun the event handler each time the image is loaded. Chrome's behaviour is non-standard and described at http://code.google.com/p/chromium/issues/detail?id=7731#c12
      let image_loader = new Image();
      image_loader.addEventListener("load", () => {
        checkImageHeight();
        document.querySelector(SELECTOR_SLIDER_IMAGES).classList.add("loaded");
      });
      image_loader.src = image.getAttribute("src");
    });
  }
  sliderPagePrefill();

  // set up constants and vars
  const SELECTOR_SLIDER_PAGERS = "ol.js__slider__pagers button";
  const SELECTOR_SLIDER_PAGERS_ACTIVE = ".js__slider__pagers button.active";
  const SELECTOR_SLIDER_IMAGES = ".js__slider__images";
  const SELECTOR_SLIDER_IMAGES_ITEM = ".slider__images-item";
  const SELECTOR_SLIDER_CONTROL_NEXT = ".slider__control--next";
  const SELECTOR_SLIDER_CONTROL_PREV = ".slider__control--prev";

  // NOTE: You may be interested in tweaking switching speed by changing this constant.
  const SLIDER_SPEED = 5000;

  const LAST_ELEM_INDEX =
    document.querySelectorAll(SELECTOR_SLIDER_PAGERS).length - 1;

  let sliderTarget = null;
  let animationOngoing = false; // HACK: Prevent from interrupting animations
  let isDocumentOnFocus = true; // HACK: Prevent the blurring from interrupting the animation

  function getFirstVisibleElem(iterable) {
    for (let i = 0; i < iterable.length; i++) {
      let elem = iterable[i];
      if (elem.style.display !== "none" && elem.style.visibility !== "hidden") {
        return elem;
      }
    }
  }

  function indexOf(iterable, elem) {
    for (let i = 0; i < iterable.length; i++) {
      if (iterable[i] === elem) {
        return i;
      }
    }
    return -1;
  }

  function fadeInOut(elemFadeIn, elemFadeOut, speed) {
    animationOngoing = true;
    let speed_ = speed || 20;
    let currentInOpac = 0;
    elemFadeIn.style.opacity = currentInOpac;
    elemFadeOut.style.opacity = 1 - currentInOpac;
    elemFadeIn.style.display = null;
    elemFadeOut.style.display = null;

    let interval = setInterval(() => {
      elemFadeIn.style.opacity = currentInOpac;
      elemFadeOut.style.opacity = 1 - currentInOpac;
      currentInOpac += 0.03;
      if (currentInOpac >= 1) {
        elemFadeIn.style.opacity = null;
        elemFadeOut.style.opacity = null;
        elemFadeOut.style.display = "none";
        clearInterval(interval);
        animationOngoing = false;
      }
    }, speed_);
  }

  function initBlurDetection() {
    document.addEventListener("blur", () => {
      isDocumentOnFocus = false;
    });
    document.addEventListener("focus", () => {
      isDocumentOnFocus = true;
    });
  }
  initBlurDetection();

  // transition function
  function sliderResponse(sliderTarget) {
    let items = document.getElementsByClassName("slider__images-item");
    fadeInOut(items[sliderTarget], getFirstVisibleElem(items), 5);
    let pagers = document.querySelectorAll(SELECTOR_SLIDER_PAGERS);
    pagers.forEach((elem) => {
      elem.classList.remove("active");
    });
    pagers[sliderTarget].classList.add("active");
  }

  // add css height to slider images list
  function checkImageHeight() {
    let sliderHeight = getFirstVisibleElem(
      document.querySelectorAll(".slider__images-image")
    ).height;
    document.querySelector(SELECTOR_SLIDER_IMAGES).style.height =
      sliderHeight + "px";
  }

  // slider timing
  function sliderTiming() {
    if (!isDocumentOnFocus) {
      return;
    }
    let currentActiveElem = document.querySelector(SELECTOR_SLIDER_PAGERS_ACTIVE);
    let currentActiveIndex = indexOf(
      currentActiveElem.parentElement.children,
      currentActiveElem
    );
    sliderTarget = currentActiveIndex;
    sliderTarget = sliderTarget === LAST_ELEM_INDEX ? 0 : sliderTarget + 1;
    sliderResponse(sliderTarget);
  }

  // ==SETUP FUNCTIONS==

  function initSliderPage() {
    window.onresize = () => {
      checkImageHeight();
    };
  }
  initSliderPage();

  // set up first slide
  function initFirstSlide() {
    document.querySelectorAll(SELECTOR_SLIDER_PAGERS)[0].classList.add("active");
    let slideImageItems = document.querySelectorAll(SELECTOR_SLIDER_IMAGES_ITEM);
    slideImageItems.forEach((elem) => {
      elem.style.display = "none";
    });
    slideImageItems[0].style.display = null;
  }
  initFirstSlide();

  // pager controls
  function initPageControl() {
    document
      .querySelectorAll(SELECTOR_SLIDER_PAGERS)
      .forEach((elem, currentIndex) => {
        elem.addEventListener("click", () => {
          if (!elem.classList.contains("active") && !animationOngoing) {
            sliderTarget = currentIndex;
            sliderResponse(sliderTarget);
            resetTiming();
          }
        });
      });

    // next/prev controls
    document
      .querySelector(SELECTOR_SLIDER_CONTROL_NEXT)
      .addEventListener("click", () => {
        if (!animationOngoing) {
          let currentActiveElem = document.querySelector(
            SELECTOR_SLIDER_PAGERS_ACTIVE
          );
          let currentActiveIndex = indexOf(
            currentActiveElem.parentElement.children,
            currentActiveElem
          );
          sliderTarget = currentActiveIndex;
          sliderTarget = sliderTarget === LAST_ELEM_INDEX ? 0 : sliderTarget + 1;
          sliderResponse(sliderTarget);
          resetTiming();
        }
      });
    document
      .querySelector(SELECTOR_SLIDER_CONTROL_PREV)
      .addEventListener("click", () => {
        if (!animationOngoing) {
          let currentActiveElem = document.querySelector(
            SELECTOR_SLIDER_PAGERS_ACTIVE
          );
          let currentActiveIndex = indexOf(
            currentActiveElem.parentElement.children,
            currentActiveElem
          );
          sliderTarget = currentActiveIndex;
          sliderTarget = sliderTarget === 0 ? LAST_ELEM_INDEX : sliderTarget - 1;
          sliderResponse(sliderTarget);
          resetTiming();
        }
      });
  }
  initPageControl();

  // slider autoplay
  let timingRun = setInterval(() => {
    sliderTiming();
  }, SLIDER_SPEED);

  function resetTiming() {
    clearInterval(timingRun);
    timingRun = setInterval(() => {
      sliderTiming();
    }, SLIDER_SPEED);
  }

})();

(function() {
  "use strict";
  document.getElementById(ELEMID_PRE_USER_AGENT).innerText = navigator.userAgent;
  document.getElementById(ELEMID_FIGURE_UNDER_CONSTRUCTION).addEventListener("click", () => {
    let deprecatedBannerElem = document.getElementById(ELEMID_H2_DEPRECATED_BANNER);
    if (isDeprecatedBannerShowing) {
      deprecatedBannerElem.setAttribute("hidden", "");
      isDeprecatedBannerShowing = false;
    } else {
      deprecatedBannerElem.removeAttribute("hidden");
      isDeprecatedBannerShowing = true;
    }
  });
})();

</script>
